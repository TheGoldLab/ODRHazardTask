function quickPS_plotVsTime(dat, fit, ax)% function quickPS_plotVsTime(dat, fit, ax)% check argsif nargin < 1 | isempty(dat)	return;endif nargin < 2  fit = [];endif nargin < 3 | isempty(ax)	ax = axes;else	axes(ax);end% Coherence and Time axescax = unique(dat(:,1));tax = unique(dat(:,2));%% COLLECT MODEL "DATA"if ~isempty(fit)  % generate list of coh- and time-dependent predictions from the model  pred = nans(length(cax),length(tax));  for i = 1:length(cax)	 pred(i,:) = quickPS_val(cax(i), tax, fit(1), fit(2), fit(3))';  endend%% COLLECT REAL DATA for different times, cohs% matrix of selection arrays for different coherencespcor = nans(length(cax),length(tax));for c = 1:length(cax)  Lc = dat(:,1) == cax(c);  for t = 1:length(tax)	 Lt = dat(:,2)==tax(t);	 Ls = Lc & Lt;	 if sum(Ls)		pcor(c,t) = sum(dat(Ls,3))/sum(Ls);	 end  endend%% PLOTco = {'c' 'm' 'r' 'g' 'b'};hold on;for i = 1:length(cax)  hobs(i) = plot(tax,pcor(i,:),'o', 'MarkerSize', 2, ...					  'MarkerFaceColor', co{i}, 'MarkerEdgeColor', co{i});  if ~isempty(fit)	 hpred(i) = plot(tax, pred(i,:), 'Color', co{i}, 'LineWidth', 1.5);  endendjigax(ax, 10);set(ax, 'XLim', [0 .8], 'XTick', 0:.1:.7, 'XTickLabel', ...    {'0' '' '200' '' '400' '' '600' ''});set(ax,'YLim', [0.45 1.0], 'YTick',[.5:.1:1]);xlabel('Viewing time (ms)');ylabel('Performance (% correct)');